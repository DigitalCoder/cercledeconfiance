{% extends 'AppBundle::layoutAppli.html.twig' %}
{% form_theme form 'bootstrap_3_layout.html.twig' %}

{% block content %}
    <div class="btnCloud">
        <a href="{{ path('accueil') }}">
            <input type="button" class="btn btn-default" value="Retourner aux cercles"/>
        </a>

        <a href="{{ path('appli', {'token': token}) }}">
            <input type="button" class="btn btn-default" value="Retourner à l'appli"/>
        </a>
    </div>
    <div class="container-fluid marginBottom text-center section-header">
        <h2 class="cloudTitle section-title">Partage de fichiers</h2>
        <p class="cloudContent">Vous avez la possibilité d'envoyer des fichiers pour les autres membres du cercle.</p>
    </div>
    {% if error is defined %}
        <h3>{{ error | raw }}</h3>
    {% else %}
        <div class="row">
            <div class="col-xs-6 col-xs-offset-3 text-center">
                {{ form(form) }}
            </div>
        </div>


        <div class="row">

            <h2 class="section-title text-center cloudListTitle">Liste des fichiers</h2>

            {% for CUser in CUsers %}
                {% for dataApp in CUser.dataApps|sort|reverse %}
                    {% if dataApp.cloud is not null %}
                        <div class="col-xs-6 col-lg-3 thumbCloud">
                            <div class="cloudBorder">
                                <div class="wallTitle">
                                    <div class="row cloudBack">
                                        <div class="col-lg-3 col-xs-3">
                                            <img src="{{ asset("uploads/" ~ dataApp.circleuser.user.avatar) }}"
                                                 class="wallAvatar img-circle" alt="avatar.png">
                                        </div>
                                        <div class="col-lg-offset-1 col-lg-8 col-xs-offset-1 col-xs-8">
                                            <h5>
                                                <i class="fa fa-folder-open wallIcon"></i><strong> {{ dataApp.circleuser.user.firstname }} {{ dataApp.circleuser.user.name }}</strong>
                                            </h5>
                                            <p>{{ dataApp.creationdate|date }}</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="marginCloud text-center">
                                    {% if "image" in dataApp.cloud.fileType %}
                                        <img src="{{ asset("uploads/" ~ dataApp.cloud.fileName) }}"
                                             alt="{{ dataApp.cloud.fileName }}" class="itemCloud img-responsive"><br/>
                                        <a class="downloadFile" href="{{ asset("uploads/" ~ dataApp.cloud.fileName) }}"
                                           download="{{ dataApp.cloud.fileName }}">
                                            <p class="text-center">Télécharger le fichier</p>
                                        </a>
                                    {% elseif "video" in dataApp.cloud.fileType %}
                                        <video controls src="{{ asset("uploads/" ~ dataApp.cloud.fileName) }}"
                                               class="itemCloud">
                                        </video><br/>
                                        <a href="{{ asset("uploads/" ~ dataApp.cloud.fileName) }}"
                                           download="{{ dataApp.cloud.fileName }}">
                                            Télécharger le fichier
                                        </a>
                                    {% elseif "application" in dataApp.cloud.fileType %}
                                        <iframe src="{{ asset("uploads/" ~ dataApp.cloud.fileName) }}"
                                                class="itemCloud">
                                        </iframe><br/>
                                        <a class="downloadFile" href="{{ asset("uploads/" ~ dataApp.cloud.fileName) }}"
                                           download="{{ dataApp.cloud.fileName }}">
                                            <p class="text-center">Télécharger le fichier</p>
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>

    {% endif %}

{% endblock %}
{% block javascript %}
    {{ parent() }}
    <script src="{{ asset('assets/js/drag.js') }}"></script>
{% endblock %}

